# CIRIS Billing - Environment Configuration
# Copy to .env and customize

# PostgreSQL Database
POSTGRES_USER=ciris
POSTGRES_PASSWORD=CHANGE_THIS_STRONG_PASSWORD
POSTGRES_DB=ciris_billing
DATABASE_URL=postgresql+asyncpg://ciris:CHANGE_THIS_STRONG_PASSWORD@postgres:5432/ciris_billing
DATABASE_URL_READ=postgresql+asyncpg://ciris:CHANGE_THIS_STRONG_PASSWORD@postgres:5432/ciris_billing

# Stripe Configuration
# Get these from https://dashboard.stripe.com/apikeys
STRIPE_API_KEY=sk_test_YOUR_TEST_KEY_HERE
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET_HERE
STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_PUBLISHABLE_KEY_HERE

# For production, use live keys:
# STRIPE_API_KEY=sk_live_YOUR_LIVE_KEY_HERE
# STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_LIVE_KEY_HERE

# Admin Authentication - Google OAuth
# Get OAuth credentials from https://console.cloud.google.com/
# 1. Create/select project
# 2. Enable Google+ API
# 3. Create OAuth 2.0 Client ID (Web application)
# 4. Add authorized redirect URI: https://billing.ciris.ai/admin/oauth/callback
#
# GOOGLE_CLIENT_ID: Primary client ID (for admin OAuth flow)
# GOOGLE_CLIENT_IDS: Comma-separated list of ALL valid client IDs for token validation
#   - Include web client ID (tokens from Android Sign-In have this as audience)
#   - Include Android client ID (tokens may have this as azp)
#   - Include any other platforms (iOS, etc.)
GOOGLE_CLIENT_ID=YOUR_WEB_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_IDS=YOUR_WEB_CLIENT_ID.apps.googleusercontent.com,YOUR_ANDROID_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YOUR_GOOGLE_CLIENT_SECRET
# Generate JWT secret with: openssl rand -hex 32
ADMIN_JWT_SECRET=CHANGE_THIS_TO_RANDOM_64_CHAR_STRING

# Apple Sign-In (for iOS clients)
# Get from Apple Developer portal: https://developer.apple.com/account/resources/identifiers/list
#
# APPLE_CLIENT_ID: iOS app bundle ID (primary)
# APPLE_CLIENT_IDS: Comma-separated list of ALL valid bundle IDs for token validation
# APPLE_TEAM_ID: Your Apple Developer Team ID (found in Membership details)
APPLE_CLIENT_ID=ai.ciris.mobile
APPLE_CLIENT_IDS=ai.ciris.mobile
APPLE_TEAM_ID=ABC123XYZ

# Apple StoreKit (App Store Server API for in-app purchases)
# Get from App Store Connect: https://appstoreconnect.apple.com/
# 1. Go to Users and Access -> Integrations -> In-App Purchase
# 2. Generate new API key, download .p8 file
# 3. Note the Key ID and Issuer ID
#
# APPLE_STOREKIT_KEY_ID: Key ID from App Store Connect
# APPLE_STOREKIT_ISSUER_ID: Issuer ID from App Store Connect
# APPLE_STOREKIT_PRIVATE_KEY: Contents of .p8 file (base64 encoded)
#   To encode: base64 -i AuthKey_XXXXXXXX.p8 | tr -d '\n'
# APPLE_STOREKIT_BUNDLE_ID: Bundle ID for purchase validation
# APPLE_STOREKIT_ENVIRONMENT: "production" or "sandbox"
APPLE_STOREKIT_KEY_ID=
APPLE_STOREKIT_ISSUER_ID=
APPLE_STOREKIT_PRIVATE_KEY=
APPLE_STOREKIT_BUNDLE_ID=ai.ciris.mobile
APPLE_STOREKIT_ENVIRONMENT=sandbox

# Test Authentication (for automated testing only - NEVER enable in production)
# Allows bypassing Google OAuth with a static token for CI/CD and integration tests
#
# User Auth (Bearer token for /v1/billing/credits/check):
# CIRIS_TEST_AUTH_ENABLED=false
# CIRIS_TEST_AUTH_TOKEN=  # Must be 64+ chars, generate with: openssl rand -hex 32
# CIRIS_TEST_USER_ID=test-user-automated
#
# Service Auth (X-API-Key for /v1/billing/litellm/usage):
# Create an API key in the database with billing:write permission, then use it
# in X-API-Key header for service-to-service calls from LiteLLM proxy.

# Legacy (deprecated - remove if not used)
JWT_SECRET_KEY=CHANGE_THIS_TO_RANDOM_64_CHAR_STRING

# Play Integrity API
# Service account JSON for calling Play Integrity API
# Get from Google Cloud Console -> IAM -> Service Accounts
# Grant: playintegrity.verifyIntegrityToken permission
PLAY_INTEGRITY_SERVICE_ACCOUNT={"type":"service_account","project_id":"..."}
# Your Android app package name
ANDROID_PACKAGE_NAME=ai.ciris.mobile

# Billing Configuration
FREE_USES_PER_ACCOUNT=3
PAID_USES_PER_PURCHASE=20
PRICE_PER_PURCHASE_MINOR=500  # $5.00 in cents

# Observability
LOG_LEVEL=INFO
GRAFANA_PASSWORD=CHANGE_THIS_STRONG_PASSWORD

# Application
PYTHONUNBUFFERED=1
